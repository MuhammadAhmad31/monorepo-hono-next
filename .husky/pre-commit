#!/usr/bin/env sh

echo ""
echo "ğŸ” Running API contract validation..."
echo ""

# Run validation in API directory
cd apps/api && bun run validate

# Check exit code
if [ $? -ne 0 ]; then
  echo ""
  echo "â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—"
  echo "â•‘          âŒ COMMIT BLOCKED                     â•‘"
  echo "â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•"
  echo ""
  echo "API routes have contract violations."
  echo "Fix the errors above before committing."
  echo ""
  echo "ğŸ’¡ TIP: Update packages/shared/src/routes.ts"
  echo "        to match your API implementation."
  echo ""
  exit 1
fi

echo ""
echo "âœ… API contract validation passed"
echo ""